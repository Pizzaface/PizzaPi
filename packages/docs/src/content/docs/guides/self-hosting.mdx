---
title: Self-Hosting
description: Deploy your own PizzaPi relay server with Docker Compose or run it manually with Bun.
sidebar:
  order: 5
---

import { Tabs, TabItem, Steps, Aside } from "@astrojs/starlight/components";

Self-hosting gives you full control over your data, no rate limits, and the ability to customize the server. The stack is two Docker services: **Redis** (event buffer) and the **PizzaPi server** (relay API + web UI).

---

## Quickest: `pizza web`

The fastest way to self-host is with a single command. No cloning, no config files — just Docker.

```bash
pizzapi web
```

This automatically:
1. Clones the PizzaPi repo (if not already present) to `~/.pizzapi/web/repo`
2. Generates a Docker Compose file in `~/.pizzapi/web/`
3. Builds and starts Redis + the relay server
4. Serves the web UI at **http://localhost:7492**

On subsequent runs, it pulls the latest changes and rebuilds if needed.

```bash
# Custom port
pizzapi web --port 8080

# Run in the foreground
pizzapi web --foreground

# Management
pizzapi web logs      # Tail container logs
pizzapi web status    # Show running containers
pizzapi web stop      # Stop the hub
```

Persistent data (SQLite database) is stored in `~/.pizzapi/web/data/`.

<Aside type="tip">
  `pizza web` is ideal for personal use or quick evaluation. For production deployments with custom domains and TLS, see the manual Docker Compose setup below.
</Aside>

---

## Manual Docker Compose

<Steps>
1. **Clone the repository**

   ```bash
   git clone https://github.com/Pizzaface/PizzaPi.git
   cd PizzaPi
   ```

2. **Start the stack**

   ```bash
   docker compose -f docker/compose.yml up -d
   ```

   This starts:

   | Service | Port | Description |
   |---------|------|-------------|
   | `redis` | 6379 | Session event buffer (internal) |
   | `server` | 7492 | Relay API + Web UI |

3. **Open the web UI**

   Navigate to **http://localhost:7492** — you'll see the PizzaPi interface.

4. **Create your account**

   The first time you visit, register an account. Then run `pizzapi setup` on your dev machine pointing to `http://localhost:7492`.
</Steps>

<Aside type="tip" title="Expose to the internet">
  To access your relay from the internet, put it behind a reverse proxy (nginx, Caddy, Traefik) with TLS. See the [HTTPS with Caddy](#https-with-caddy) section below.
</Aside>

---

## Environment Variables

Configure the server by setting environment variables in Docker Compose or your shell:

| Variable | Default | Description |
|----------|---------|-------------|
| `PORT` | `7492` | HTTP/WebSocket listen port |
| `PIZZAPI_REDIS_URL` | — | Redis connection URL, e.g. `redis://localhost:6379` |
| `PIZZAPI_BASE_URL` | `http://localhost:5173` | Public URL of the UI, added to CORS trusted origins |
| `PIZZAPI_EXTRA_ORIGINS` | — | Comma-separated extra trusted origins (e.g. a Tailscale URL). Added to CORS and WebSocket auth without hardcoding hostnames. Example: `https://myhost.ts.net,http://myhost.ts.net:5173` |

See the [Environment Variables reference](/reference/environment-variables) for the full list.

### Custom `docker/compose.yml` overrides

```yaml
# docker/compose.override.yml  (not committed — create locally)
services:
  server:
    environment:
      PORT: "8080"
      PIZZAPI_REDIS_URL: redis://redis:6379
    ports:
      - "8080:8080"
```

---

## Development Stack

Hot-reloading dev server for contributors:

```bash
# Start both the API server and Vite UI dev server
docker compose -f docker/compose.yml --profile dev up
```

| Service | Port | Description |
|---------|------|-------------|
| `redis` | 6379 | Redis |
| `server` (dev) | 3001 | Bun dev server (hot-reload) |
| `ui` (dev) | 5173 | Vite UI dev server |

Or run without Docker:

```bash
# Prerequisites: Bun, Redis running locally
bun install
bun run dev
# API → http://localhost:3001
# UI  → http://localhost:5173
```

---

## Running Without Docker

If you prefer not to use Docker:

<Steps>
1. **Install Bun**

   ```bash
   curl -fsSL https://bun.sh/install | bash
   ```

2. **Start Redis**

   ```bash
   # macOS via Homebrew
   brew install redis && brew services start redis

   # Ubuntu/Debian
   sudo apt install redis-server && sudo systemctl start redis
   ```

3. **Install dependencies and build**

   ```bash
   bun install
   bun run build
   ```

4. **Run the server**

   ```bash
   cd packages/server
   PIZZAPI_REDIS_URL=redis://localhost:6379 bun run start
   ```
</Steps>

---

## Database

The server uses **SQLite** (via Kysely) for user accounts and session metadata. The database file lives at `packages/server/auth.db`.

### Running Migrations

After upgrading PizzaPi, always run migrations before starting the server:

```bash
bun run migrate
```

### Backup

```bash
# Simple backup — safe to copy while the server is stopped
cp packages/server/auth.db packages/server/auth.db.backup
```

---

## HTTPS with Caddy

Caddy automatically provisions TLS certificates via Let's Encrypt:

```text
# /etc/caddy/Caddyfile
relay.example.com {
    reverse_proxy localhost:7492
}
```

```bash
sudo systemctl reload caddy
```

Then update your CLI config to use the secure URL:

```bash
pizzapi setup
# Relay server URL: https://relay.example.com
```

---

## Updating

```bash
cd PizzaPi
git pull
docker compose -f docker/compose.yml build
docker compose -f docker/compose.yml up -d
```

Always run `bun run migrate` if you're running without Docker.

---

## Web Push Notifications

The server supports browser push notifications for session events. Push is configured automatically — no additional setup required. Users can opt in from the web UI's notification settings.
